<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Kết Quả Học Tập - Tài Việt</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
body { 
      font-family: 'Montserrat', sans-serif; 
      margin: 0; 
      padding: 0; /* Đưa về 0 */
      background: #fff; 
      display: flex; 
      justify-content: center; 
      align-items: flex-start; /* Thay vì center, đưa lên sát đỉnh */
    }

    .main-app { 
      width: 100%; 
      max-width: 450px; 
      text-align: center; 
      padding: 5px 10px; /* Giảm padding phía trên từ 20px xuống 5px */
    }

    .logo { 
      width: 120px; /* Có thể chỉnh to/nhỏ tùy ý */
      margin-top: 0; /* Sát mép trên */
      margin-bottom: 5px; 
    }

    h2 { 
      font-size: 20px; 
      color: #333; 
      margin: 0px 0; /* Giảm khoảng cách giữa các dòng chữ */
      text-transform: uppercase; 
    }

    .sub-title { 
      font-size: 14px; 
      color: #d63031; 
      font-weight: 700; 
      margin-bottom: 10px; /* Giảm khoảng cách xuống ô nhập liệu */
      display: block; 
    }
    .search-box { display: flex; flex-direction: column; align-items: center; gap: 15px; }
   input[type="text"] {
        width: 60%;
        padding: 10px 15px; /* Giảm độ cao một chút cho thanh thoát */
        margin-bottom: 15px;
        border: 1px solid #ddd;
        border-radius: 25px; /* Bo tròn mềm mại */
        font-size: 16px;
        box-sizing: border-box; /* Giúp ô nhập không bị tràn lề */
        text-align: center;
        outline: none;
    }
button {
    width: 60%; 
    padding: 10px;
    background: linear-gradient(135deg, #2ecc71, #27ae60);
    color: white;
    border: none;
    
    /* BO VIỀN NÚT ĐỒNG BỘ VỚI Ô NHẬP */
    border-radius: 8px; 
    
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(46, 204, 113, 0.2);
}
    button { width: 160px; border-radius: 50px; padding: 12px; border: none; background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%); color: white; font-weight: 700; cursor: pointer; box-shadow: 0 4px 10px rgba(0, 176, 155, 0.2); }
    button:disabled { background: #ccc; cursor: not-allowed; }
    #result { margin-top: 25px; text-align: left; display: none; }
    .student-info { background: #f0fdf4; border-radius: 12px; padding: 15px; margin-bottom: 15px; border-left: 5px solid #00b09b; }
    .score-item { display: flex; justify-content: space-between; padding: 12px 10px; border-bottom: 1px solid #f1f2f6; align-items: center; }
    .badge { font-weight: 800; padding: 5px 12px; border-radius: 8px; min-width: 45px; text-align: center; }
    .good { background: #dcfce7; color: #15803d; }
    .avg { background: #fef9c3; color: #a16207; }
    .low { background: #fee2e2; color: #b91c1c; }
  </style>
</head>
<body>
  <div class="main-app">
    <img src="https://i.postimg.cc/DwFwF1z1/IMG-1767000026090-1767005512540.jpg" class="logo">
    <h2>KẾT QUẢ HỌC TẬP</h2>
    <span class="sub-title">NGOẠI NGỮ TÀI VIỆT</span>
    <div class="search-box">
      <input type="text" id="maHS" placeholder="Nhập mã học viên..." onkeypress="if(event.key==='Enter') search()">
      <button onclick="search()" id="btn">TRA CỨU</button>
    </div>
    <div id="result"></div>
  </div>

  <script>
    function search() {
      const ma = document.getElementById("maHS").value.trim();
      const resDiv = document.getElementById("result");
      const btn = document.getElementById("btn");
      if (!ma) return;

      // DÁN LINK WEB APP CỦA BẠN VÀO DÒNG DƯỚI ĐÂY
      const scriptUrl = "https://script.google.com/macros/s/AKfycbwexmMLys25p4vo6NyeKFasqB0PX3ZgUt3nWezWf4gsEmrDTlLIsgvH8MT-4hzzwyLF/exec";

      resDiv.style.display = "block";
      resDiv.innerHTML = "<p style='text-align:center'>Đang tải dữ liệu...</p>";
      btn.disabled = true;

      fetch(scriptUrl + "?ma=" + encodeURIComponent(ma))
        .then(response => response.json())
        .then(res => {
          btn.disabled = false;
          if (res.found) {
            let html = `
              <div class="student-info">
                <i class="fas fa-user"></i> <b>${res.ten}</b><br>
                <i class="fas fa-graduation-cap"></i> <small>Lớp: ${res.lop}</small>
              </div>`;
            
            if(res.diem.length === 0) {
              html += "<p style='text-align:center; color: gray;'>Chưa có dữ liệu điểm.</p>";
            } else {
              res.diem.forEach(item => {
                let val = parseFloat(item.diem);
                let cls = isNaN(val) ? 'avg' : (val < 5 ? 'low' : (val < 8 ? 'avg' : 'good'));
                html += `
                  <div class="score-item">
                    <span><i class="fas fa-book"></i> ${item.mon}</span>
                    <span class="badge ${cls}">${item.diem}</span>
                  </div>`;
              });
            }
            resDiv.innerHTML = html;
          } else {
            resDiv.innerHTML = "<p style='color:red; text-align:center; font-weight:bold;'>Mã học sinh không tồn tại!</p>";
          }
        })
        .catch(err => {
          btn.disabled = false;
          resDiv.innerHTML = "<p style='color:red; text-align:center;'>Lỗi kết nối! Vui lòng kiểm tra lại link Web App.</p>";
        });
    }
  </script>
</body>
</html>
